# 2025-03-27

# 1.동기와 비동기 프로그래밍

## 1.동기(Synchronous)란?

- 한 줄씩 차례로 실행되는 방식
- 앞의 코드가 끝나야 다음 코드가 실행됨
- 기다림 없이 순차적으로 실행되는 코드
- 장점 : 예측 가능하고 이해하기 쉬움
- 단점 : 시간이 오래 걸리는 작업이 있으면 전체 흐름이 멈춰버림

## 2. 비동기(Asynchronous)란?

- 시간이 오래 걸리는 작업은 나중에 처리하고, 그동안 다른 작업을 먼저 실행하는 방식
- `Future`, `async`, `await` 를 사용함.
- 서버에서 데이터를 받아오거나, 파일 읽기 등의 작업은 결과가 바로 나오지 않음. 기다릴 필요가 있는 작업이기에 Dart는 이런 작업을 처리할 때 전체 프로그램이 멈추지 않도록 비동기 처리를 함

### 2-1. `Future` — “나중에 값이 생겨요”

- 한 번에 하나의 결과만 전달
- 미래에 어떤 작업이 끝나면 결과를 돌려주는 약속(promise) 같은 개념.
- 값이 안들어오면 에러를 발생시킴

### 2-2. `async` / `await` — "기다려서 쓸게요"

- `async`: 이 함수는 **비동기** 작업이다, 라고 Dart에게 알려주는 키워드
- `await`: **이 작업 끝날 때까지 기다렸다가 다음 코드 실행해**
- `Future`를 기다릴 때 `await`을 쓰고, 그걸 쓰는 함수에는 `async`를 붙여줘야 해.

### 2-2. `Stream` — "계속해서 값이 흘러와요"

- 여러 개의 값을 **순차적으로 전달하는 비동기 데이터 흐름**
- **Future는 1개의 값**, Stream은 **여러 값**이 시간에 따라 도착한다.
- 주로 채팅 메세지 수신, 센서 데이터 실시간 수신에 쓴다

# 2. 동시성과 병렬성

## 1. 동시성 (Concurrency)

- 여러 작업을 *동시에 실행하는 것처럼 보이게* 처리하는 방식
- Dart에서는 주로 **`async`/`await`**, **`Future`**, 그리고 **`Stream`**으로 동시성을 처리
- 모든 코드가 **단일 스레드**(main isolate)에서 돌아가지만, **비동기 작업을 대기하는 동안 다른 작업을 처리**할 수 있어서 사용자 경험이 좋아진다.
- 서버에서 데이터를 받아오는 동안 UI는 멈추지 않고 다른 일을 계속 하는 걸 생각하기

## 2. 병렬성 (Parallelism)

- 여러 스레드에서 동시에 작업을 처리하는 방식
- 이미지 필터 처리나 큰 JSON 파일 파싱처럼 시간이 오래 걸리는 작업을 단일 메모리에서 처리하려면 UI가 멈출 수 있지만, 새로운 별도 메모리를 만들어 독립적으로 처리하면 앱이 멈추지 않음.

# 3. 콜백 함수와 콜백 지옥

## 1. 콜백 함수

- 다른 함수의 인자로 전달되어 특정 이벤트나 작업이 완료되었을 때 호출되는 함수
- 나중에 실행되도록 등록해 두는 함수

## 2. 문제점(콜백 지옥)

```dart
getUser((user) {
  getProfileImage(user.id, (image) {
    downloadImage(image.url, (file) {
      showOnScreen(file);
    });
  });
});
```

- 괄호가 계속 안쪽으로 깊어지고,
- 왼쪽에서 오른쪽으로 밀리고, 들여쓰기도 헷갈림
- 순서도 중요하고, 한 단계라도 빼먹으면 전체 흐름이 깨짐
- 처음엔 간단해 보이지만, 로직이 많아질수록, **“누가 누구 안에서 실행되는지”**, **“언제 실행되는지” 이해하고 파악하기 점점 힘들어짐**

### 2-1. 해결법

```dart
final user = await getUser();
final image = await getProfileImage(user.id);
final file = await downloadImage(image.url);
showOnScreen(file);
```

- 이걸 피하려고 `Future`와 `async/await` 문법을 사용한다.
- 훨씬 가독성이 좋아지고,
- 순차 흐름이 눈에 보이고,
- 들여쓰기도 덜하고,
- 중첩이 없어진다.